<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRITICAL: Certificate Has Expired</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fafafa;
        }
        .email-container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            border: 3px solid #d32f2f;
        }
        .header {
            background-color: #d32f2f;
            color: white;
            padding: 30px;
            border-radius: 8px 8px 0 0;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 28px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .alert-icon {
            font-size: 64px;
            margin-bottom: 15px;
            animation: shake 1s infinite;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .expired-stamp {
            background-color: #d32f2f;
            color: white;
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            transform: rotate(-5deg);
            border: 4px solid #b71c1c;
        }
        .cert-details {
            background-color: #ffebee;
            border-left: 8px solid #d32f2f;
            padding: 25px;
            margin: 25px 0;
        }
        .status-badge {
            background-color: #d32f2f;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 3px 8px rgba(211,47,47,0.4);
        }
        .action-section {
            background-color: #fff3e0;
            border: 3px solid #ff5722;
            border-radius: 10px;
            padding: 25px;
            margin: 25px 0;
        }
        .critical-box {
            background-color: #ffebee;
            border: 2px solid #f44336;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .footer {
            border-top: 3px solid #d32f2f;
            padding-top: 25px;
            margin-top: 35px;
            font-size: 12px;
            color: #666;
            text-align: center;
        }
        .highlight {
            background-color: #ffcdd2;
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            color: #b71c1c;
        }
        .impact-item {
            margin: 10px 0;
            padding: 10px;
            background-color: #fff8e1;
            border-left: 4px solid #ff5722;
        }
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <div class="alert-icon">üíÄ</div>
            <h1>CERTIFICATE EXPIRED</h1>
            <p>Service disruption in progress!</p>
        </div>

        <div class="expired-stamp">
            EXPIRED
        </div>

        <p style="color: #d32f2f; font-size: 18px; font-weight: bold; text-align: center;">
            üö® CRITICAL SERVICE OUTAGE ALERT üö®
        </p>
        
        <p><strong style="color: #d32f2f;">Your certificate has EXPIRED and services are likely affected!</strong></p>
        
        <p>This certificate expired {% if days_until_expiry == 0 %}today{% else %}{{ days_until_expiry|abs }} days ago{% endif %} and immediate action is required to restore service availability.</p>

        <div class="cert-details">
            <h3>üíî Expired Certificate Information</h3>
            <table style="width: 100%; border-collapse: collapse;">
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Certificate:</td>
                    <td style="padding: 10px 0; color: #d32f2f; font-weight: bold; font-size: 16px;">{{ certificate_name }}</td>
                </tr>
                {% if certificate_organization %}
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Organization:</td>
                    <td style="padding: 10px 0;">{{ certificate_organization }}</td>
                </tr>
                {% endif %}
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Serial Number:</td>
                    <td style="padding: 10px 0;"><code>{{ serial_number[:16] }}...</code></td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Issued By:</td>
                    <td style="padding: 10px 0;">{{ issuer_name }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Expired On:</td>
                    <td style="padding: 10px 0; color: #d32f2f; font-weight: bold; font-size: 18px;">{{ expiry_date[:10] }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; font-weight: bold;">Status:</td>
                    <td style="padding: 10px 0;"><span class="status-badge">EXPIRED</span></td>
                </tr>
            </table>
        </div>

        <div class="action-section">
            <h3 style="color: #ff5722;">üö® EMERGENCY ACTIONS REQUIRED NOW</h3>
            <ol style="font-weight: bold;">
                <li style="margin: 10px 0;">üî• <strong>STOP EVERYTHING - Focus on certificate renewal</strong></li>
                <li style="margin: 10px 0;">üìû <strong>Contact certificate provider immediately</strong> - emergency renewal</li>
                <li style="margin: 10px 0;">‚ö° <strong>Request expedited processing</strong> if available</li>
                <li style="margin: 10px 0;">üöÄ <strong>Deploy new certificate ASAP</strong> once obtained</li>
                <li style="margin: 10px 0;">üì¢ <strong>Notify users/customers</strong> about service issues</li>
                <li style="margin: 10px 0;">üìä <strong>Monitor service restoration</strong> after deployment</li>
                <li style="margin: 10px 0;">üìù <strong>Post-incident review</strong> - prevent future occurrences</li>
            </ol>
        </div>

        <div class="critical-box">
            <h3 style="color: #d32f2f;">üí• CURRENT SERVICE IMPACT</h3>
            <p><strong>Your services are experiencing these issues RIGHT NOW:</strong></p>
            
            <div class="impact-item">üö´ <strong>Complete service outage:</strong> Applications are inaccessible to users</div>
            <div class="impact-item">üîí <strong>SSL/TLS failures:</strong> All secure connections are rejected</div>
            <div class="impact-item">‚ö†Ô∏è <strong>Browser warnings:</strong> Users see "Your connection is not private" errors</div>
            <div class="impact-item">üíº <strong>Business disruption:</strong> Revenue loss and customer dissatisfaction</div>
            <div class="impact-item">üì± <strong>Mobile app failures:</strong> Apps crash or show connection errors</div>
            <div class="impact-item">üîç <strong>SEO impact:</strong> Search engines may mark site as unsafe</div>
            <div class="impact-item">üìß <strong>Email services:</strong> Secure email may be disrupted</div>
        </div>

        <div style="background-color: #ffebee; padding: 20px; border-radius: 8px; border: 2px solid #d32f2f; margin: 25px 0;">
            <h3 style="color: #d32f2f; text-align: center;">‚è∞ DOWNTIME TRACKER</h3>
            <p style="text-align: center; font-size: 18px;">
                <strong>Service has been down for:</strong><br>
                {% if days_until_expiry == 0 %}
                    <span style="color: #d32f2f; font-size: 24px; font-weight: bold;">Less than 24 hours</span>
                {% else %}
                    <span style="color: #d32f2f; font-size: 24px; font-weight: bold;">{{ days_until_expiry|abs }} days</span>
                {% endif %}
            </p>
        </div>

        <p style="background-color: #ffebee; padding: 20px; border-radius: 8px; border-left: 6px solid #d32f2f;">
            <strong>üìß This CRITICAL alert was sent to:</strong> <span class="highlight">{{ certificate_email }}</span><br>
            <strong>üìÇ Certificate file:</strong> {{ certificate_filename }}<br>
            <strong>üïê Alert sent:</strong> {{ "now"|strftime('%Y-%m-%d %H:%M:%S UTC') }}
        </p>

        <div class="footer">
            <p><strong style="color: #d32f2f;">This is a CRITICAL SERVICE OUTAGE alert from qPKI Certificate Management System.</strong></p>
            <p>Daily alerts will continue until the certificate is renewed and services are restored.</p>
            <p><strong>If you have renewed this certificate, please update your systems immediately.</strong></p>
        </div>
    </div>
</body>
</html>
